// DO NOT EDIT THIS FILE - it is generated from README.adoc.template
// Make changes to the template file instead: templates/docs/README.adoc.template
// To regenerate: ./build-app --generate-docs

# cattywampus
:doctype: article
:toclevels: 3
:hide-uri-scheme:
:icons: font
:idprefix:
:idseparator: -
:source-language: shell
ifndef::env-github[:icons: font]
ifdef::env-github[]
:status:
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :information_source:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

== Overview

cattywampus is a utility that removes certain metadata from Matroska (.mkv) and MP4/M4V (.mp4, .m4v, .mp4v) video files.

=== For MKV files:
. Segment info title (the "main" title that displays when opening the video in a player)
. Video track 1 name (the name of the video track that shows in player menus)
. Audio track 1 name (optional - use `-a`/`--clear-audio` CLI flag or `clearAudio = true` config option to enable) 

Optionally, cattywampus can set the first embedded subtitle track in your preferred language to default (MKV files only), so that subtitle track will automatically show when the video is opened in a video player that supports embedded subtitles, such as VLC.

=== For MP4/M4V files:
. Title metadata atom
. Description metadata atom


== Installation

=== Installing Prerequisites

cattywampus uses link:https://mkvtoolnix.download/[MKVToolnix^] to process MKV videos and link:https://github.com/wez/atomicparsley[AtomicParsley^] to process MP4 videos. Both are available for a wide range of platforms and support various installation methods through package managers via direct installation.

NOTE: If you only want to process MKV videos (or only MP4 videos), see the `onlyMkv`/`onlyMp4`/`--only-mkv`/`--only-mp4`  options in the link:#usage[Usage] section below. You can install MKVToolnix, AtomicParsely or both, depending on your needs. 

Install these packages on your system by following their official instructions.

Suggested installation: use link:https://brew.sh/[Homebrew^] (Linux/macOS) or link:https://winget.run/[WinGet^] / link:https://chocolatey.org/[Chocolatey^] (Windows).

++++
<details>
<summary>Linux/macOS Installation</summary>
++++

[source,shell]
----
brew install mkvtoolnix atomicparsley
----

++++
</details>
++++

++++
<details>
<summary>Windows Installation</summary>
++++

**Via Winget (Windows Package Manager)**

[source,console]
----
winget install MoritzBunkus.MKVToolNix
winget install AtomicParsley.AtomicParsley
----

**Via Chocolatey**

[source,console]
----
choco install mkvtoolnix
choco install atomicparsley
----

++++
</details>
++++

=== Installing cattywampus

++++
<details>
<summary>Linux Installation</summary>
++++

1. Download the Linux binary from the link:https://github.com/Taco-Comovilla/cattywampus/releases/latest[latest release^]
2. Extract the compressed file:
+
[source,shell]
----
gunzip cattywampus-linux-*.gz
----

3. Make the binary executable and move it to your PATH:
+
[source,shell]
----
chmod +x cattywampus
sudo mv cattywampus /usr/local/bin/ # or somewhere in your PATH
----

4. Install file manager integrations (optional but recommended):
+
If you want context menu integration, clone the repository to get the installation script:
+
[source,shell]
----
git clone https://github.com/Taco-Comovilla/cattywampus.git
cd cattywampus
./install
----
+
This script will install context menu integrations for multiple file managers:
+
* **Nautilus** (GNOME Files) - Python extension + desktop actions
* **Dolphin** (KDE) - Service menus
* **Thunar** (XFCE) - Custom actions  
* **Caja** (MATE) - Scripts
+
**Upgrade Behavior**: If you already have cattywampus installed, the script will detect the existing installation and prompt you to uninstall it first. This ensures a clean upgrade without conflicts. You can:
+
* Press **Enter** or type **y** to proceed with automatic uninstall (recommended)
* Type **n** to cancel and manually uninstall first using `./uninstall`
* Use `./install --force` to skip the prompt in automated scenarios
* Use `./install --skip-uninstall` to bypass uninstall detection entirely
+
Your personal configuration will be preserved during upgrades.

++++
</details>
++++

++++
<details>
<summary>macOS Installation</summary>
++++

1. Download the macOS binary from the link:https://github.com/Taco-Comovilla/cattywampus/releases/latest[latest release^]
2. Extract the compressed file:
+
[source,shell]
----
gunzip cattywampus-macos-*.gz
----

3. Make the binary executable and move it to your PATH:
+
[source,shell]
----
chmod +x cattywampus
sudo mv cattywampus /usr/local/bin/ # or somewhere in your PATH
----

4. Install Finder Quick Action (optional but recommended):
+
If you want Finder context menu integration, clone the repository to get the installation script:
+
[source,shell]
----
git clone https://github.com/Taco-Comovilla/cattywampus.git
cd cattywampus
./install
----
+
This script will install a Finder Quick Action that adds "Clean with cattywampus" to the right-click context menu for video files and folders in Finder.
+
**Upgrade Behavior**: If you already have cattywampus installed, the script will detect the existing installation and prompt you to uninstall it first. This ensures a clean upgrade without conflicts. Your personal configuration will be preserved during upgrades.
+
NOTE: You may need to enable the Quick Action in System Settings > Privacy & Security > Extensions > Finder Extensions after installation.

++++
</details>
++++

++++
<details>
<summary>Windows Installation</summary>
++++

**Option 1: Installer (Recommended)**

1. Download the Windows installer from the link:https://github.com/Taco-Comovilla/cattywampus/releases/latest[latest release^]
2. Run `Setup-cattywampus-1.0.0.exe`
3. Follow the installation wizard

The installer will:

* Install cattywampus to `Program Files`
* Add cattywampus to your system PATH
* Install Windows Explorer context menu integration
* Create an uninstaller for easy removal

**Option 2: Portable Binary**

1. Download the Windows binary from the link:https://github.com/Taco-Comovilla/cattywampus/releases/latest[latest release^]
2. Extract the ZIP file to your preferred location
3. Add the binary to your PATH (optional):
+
Add the directory where you extracted cattywampus.exe to your PATH environment variable, or copy `cattywampus.exe` to a directory already in your PATH.

NOTE: The portable binary does not include Explorer context menu integration. For GUI usage, use the installer.

++++
</details>
++++

== Uninstallation

=== Removing File Manager Integrations

If you installed the application on Linux or macOS using `./install`, you can remove it with:

[source,shell]
----
./uninstall
----

This script will remove the application folder, configuration, logs, and file manager integrations. Use `--integrations` to only remove file manager integrations, `--preserve-config` to keep your personal settings, or `--dry-run` to see what would be removed without making changes:

[source,shell]
----
# Remove everything (app folder + integrations) - prompts before removing config
./uninstall

# Remove integrations only (keep app folder and config)
./uninstall --integrations

# Remove integrations and binary, but preserve configuration and logs
./uninstall --preserve-config

# Preview what would be removed
./uninstall --dry-run

# Preview preserving config
./uninstall --dry-run --preserve-config
----

The uninstall script removes:

* **Linux**: Binary from `~/.local/bin`, Nautilus integrations, KDE service menus, XFCE custom actions, MATE scripts
* **macOS**: Finder Quick Actions from `~/Library/Services`

=== Windows Uninstallation

If you used the Windows installer, use "Add or Remove Programs" in Windows Settings to uninstall cattywampus. The uninstaller will remove the application and all Explorer context menu integrations.

For portable installations, simply delete the cattywampus.exe file.

== Usage

=== Windows Explorer

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and right-click on one, and choose "Clean with cattywampus" from the context menu.

=== Linux

NOTE: The file manager integrations below require running `./install` during installation (see link:#installing-cattywampus[Linux Installation] section above). Without this step, the context menu options will not be available.

++++
<details>
<summary>Nautilus (GNOME Files)</summary>
++++

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and choose "Clean with cattywampus" from the context menu.

The integration provides multiple access methods:

* **Python extension** - Direct context menu integration
* **Desktop actions** - Additional menu entries for file associations
* **Scripts** - Alternative access through the Scripts menu

++++
</details>
++++

++++
<details>
<summary>Dolphin (KDE)</summary>
++++

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and choose "Clean with cattywampus" from the context menu.

The integration installs KDE service menus that provide context menu entries for video files and folders in Dolphin file manager.

++++
</details>
++++

++++
<details>
<summary>Thunar (XFCE)</summary>
++++

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and choose "Clean with cattywampus" from the context menu.

The integration installs XFCE custom actions that provide context menu entries for video files and folders in Thunar file manager.

++++
</details>
++++

++++
<details>
<summary>Caja (MATE)</summary>
++++

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and choose "Clean with cattywampus" from the Scripts menu.

The integration installs MATE scripts that provide context menu entries for video files and folders in Caja file manager through the Scripts submenu.

++++
</details>
++++

=== macOS

NOTE: The Finder Quick Action below requires running `./install` during installation (see link:#installing-cattywampus[macOS Installation] section above). Without this step, the context menu option will not be available.

Right-click on any folder, or select one or more .mkv, .mp4, or .m4v files and choose "Clean with cattywampus" from the Quick Actions section of the context menu.

The integration installs a Finder Quick Action that provides context menu access for video files and folders in Finder.

=== Command Line Interface

[source,console]
----
cattywampus [OPTIONS] <folder_or_file_path1> [<folder_or_file_path2> ...]
----

==== Basic CLI Usage Examples

[source,console]
----
# Process single file (MKV or MP4/M4V)
cattywampus video.mkv
cattywampus movie.mp4

# Process multiple files
cattywampus movie1.mkv movie2.mp4 series/episode*.mkv

# Process folder recursively (both MKV and MP4/M4V files)
cattywampus /path/to/video/folder

# Dry run to see what would be done
cattywampus --dry-run /path/to/videos

# Only process MKV files in a mixed folder
cattywampus --only-mkv /path/to/mixed/videos

# Only process MP4/M4V files in a mixed folder
cattywampus --only-mp4 /path/to/mixed/videos

# Process files from a list
cattywampus --input file_list.txt

# Enable default subtitle track setting with custom language (MKV only)
cattywampus --set-default-subtitle --language es /path/to/spanish/videos

# Enable default audio track setting with custom language (MKV only)
cattywampus --set-default-audio --language es /path/to/spanish/videos

# Clear audio track 1 names in MKV files (audio tack 1 names will be removed)
cattywampus --clear-audio /path/to/mkv/files

# Use a custom configuration file
cattywampus --config /path/to/custom/config.toml /path/to/videos

# Show debug output on console for troubleshooting
cattywampus --stdout /path/to/videos

# Combine stdout with dry-run for debugging
cattywampus -S --dry-run /path/to/videos

# Output only to console, suppressing log file (useful for CI/scripts)
cattywampus --stdout-only /path/to/videos

# Combine stdout-only with dry-run for console-only debugging
cattywampus -O --dry-run /path/to/videos
----

=== CLI Options

==== Positional Arguments

`paths`:: Files or folders to process. Multiple paths can be specified.

==== Input Options

`-i, --input FILE`:: Read file paths from a text file (one path per line). Useful for processing large numbers of files.

`-d, --dry-run`:: Show what would be done without actually modifying files. Useful for testing and verification.

==== File Filtering

`--only-mkv`:: Only process MKV files, ignore MP4/M4V files when processing folders or mixed file lists. Default: false

`--only-mp4`:: Only process MP4/M4V files, ignore MKV files when processing folders or mixed file lists. Default: false

NOTE: The `--only-mkv` and `--only-mp4` options cannot be used together.

==== MKV-Specific Options

`-a, --clear-audio`:: Clear audio track names in MKV files. When enabled, removes the name metadata from audio track 1. Default: false (preserve existing audio track names)

==== Language and Subtitle Options (MKV files only)

`-L, --language LANG`:: Override the default language setting. Use BCP 47 language codes (e.g., 'en' for English, 'es' for Spanish, 'fr' for French). Default: auto-detect from system locale

`-s, --set-default-subtitle`:: Enable automatic setting of the first subtitle track in your preferred language as the default track. Only applies to MKV files. Default: false

`-f, --force-default-first-subtitle`:: Force the first subtitle track (regardless of language) to be set as the default track. Only applies to MKV files. Default: false

`-A, --set-default-audio`:: Enable automatic setting of the first audio track in your preferred language as the default track. Only applies to MKV files. Default: false

NOTE: Audio track and subtitle track options only apply to MKV files. MP4/M4V files do not support these metadata modifications.

==== Tool Paths

`-M, --mkvmerge-path PATH`:: Override the path to the mkvmerge binary (used for MKV metadata reading). Use when mkvmerge is not in your PATH or you want to use a specific version. Default: auto-detect from PATH

`-P, --mkvpropedit-path PATH`:: Override the path to the mkvpropedit binary (used for MKV metadata modification). Use when mkvpropedit is not in your PATH or you want to use a specific version. Default: auto-detect from PATH

`-T, --atomicparsley-path PATH`:: Override the path to the AtomicParsley binary (used for MP4/M4V metadata modification). Use when AtomicParsley is not in your PATH or you want to use a specific version. Default: auto-detect from PATH

==== Configuration

`-c, --config PATH`:: Use a custom configuration file path instead of the default config location. The file must be in TOML format. Default: auto-detect from system config directory

==== Debugging and Logging

`-g, --loglevel LEVEL`:: Override the log level. Choices: 10 (DEBUG), 20 (INFO), 30 (WARNING), 40 (ERROR), 50 (CRITICAL). Default: 20 (INFO)

`-S, --stdout`:: Send program output to console (stdout) as well as log file. Respects the configured log level. Useful for development, troubleshooting, or when you want to see real-time output. Default: false

`-O, --stdout-only`:: Send program output to console (stdout) only, suppressing log file output. Respects the configured log level. Useful for CI/CD pipelines, containers, or when you want console-only output. Default: false

`-l, --logfile PATH`:: Override the log file path. Specify a custom location for the log file. Default: auto-generate in config directory


== Configuration File

Some options can be set in config.toml. This file will be generated on first use and saved in one of the following locations:

- Linux: either `~/.config/cattywampus` or `$XDG_CONFIG_HOME/cattywampus`
- macOS: `~/Library/Application Support/cattywampus`
- Windows: `%LOCALAPPDATA%\cattywampus`

=== Configuration Options

`mkvmergePath`:: Specifies the full path to the mkvmerge binary (required for MKV files), in case it is not found in your PATH. Default: "" (auto-detect from PATH)

- Linux: `/usr/bin/mkvmerge`
- macOS: `/opt/homebrew/bin/mkvmerge`
- Windows: `C:\Program Files\MKVToolNix\mkvmerge.exe`

`mkvpropeditPath`:: Specifies the full path to the mkvpropedit binary (required for MKV files), in case it is not found in your PATH. Default: "" (auto-detect from PATH)

`atomicParsleyPath`:: Specifies the full path to the AtomicParsley binary (required for MP4/M4V files), in case it is not found in your PATH. Default: "" (auto-detect from PATH)

`language`:: Default language preference for subtitle track processing (link:https://en.wikipedia.org/wiki/IETF_language_tag[BCP 47 language tag^]). Default: "" (uses system locale unless useSystemLocale is false)

`clearAudio`:: Boolean to enable clearing of audio track names in MKV files. When true, removes name metadata from audio track 1. Default: false

`setDefaultSubtitle`:: Boolean to enable automatic default subtitle track setting (MKV files only). Default: false

`forceDefaultFirstSubtitle`:: Boolean to force first subtitle track as default regardless of language (MKV files only). Default: false

`setDefaultAudio`:: Boolean to enable automatic default audio track setting (MKV files only). Default: false

`logLevel`:: Default logging level (10=DEBUG, 20=INFO, 30=WARNING, 40=ERROR, 50=CRITICAL). Default: 20 (INFO)

`stdout`:: Boolean to enable console output in addition to log file. Respects the configured log level and sends output to both console and log file. Default: false

`stdoutOnly`:: Boolean to enable console output only, suppressing log file output. Respects the configured log level and sends output only to console. Useful for containerized environments or CI/CD pipelines. Default: false

`useSystemLocale`:: Boolean to automatically detect and use system language for subtitle preferences. Default: true

`onlyMkv`:: Boolean to only process MKV files (ignore MP4/M4V files). Default: false

`onlyMp4`:: Boolean to only process MP4/M4V files (ignore MKV files). Default: false

NOTE: The `onlyMkv` and `onlyMp4` configuration options cannot both be set to true.
